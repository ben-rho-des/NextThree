{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\n\nvar _this = this,\n    _jsxFileName = \"/home/t3hk/development/NextThree/components/blob/blob.js\",\n    _s = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { Suspense, useEffect, useMemo, useRef, useState } from 'react';\nimport styled from 'styled-components';\nimport * as THREE from 'three';\nimport * as meshline from 'threejs-meshline';\nimport { Canvas, useFrame, useLoader, useThree, useUpdate } from 'react-three-fiber';\nimport CameraControls from './controls';\nimport { fragmentShader, vertexShader, pointVertexShader, pointFragmentShader } from './vertexShader'; // import { useSpring, animated } from '@react-spring/three'\n\nvar start = Date.now();\n\nvar LeBlob = function LeBlob(props) {\n  _s();\n\n  // This reference will give us direct access to the mesh\n  var mesh = useRef();\n  var shader = useRef();\n  var pointShader = useRef();\n  var _props$includePoints = props.includePoints,\n      includePoints = _props$includePoints === void 0 ? false : _props$includePoints,\n      _props$rotateSpeed = props.rotateSpeed,\n      rotateSpeed = _props$rotateSpeed === void 0 ? 0.09 : _props$rotateSpeed,\n      _props$speed = props.speed,\n      speed = _props$speed === void 0 ? 0.4 : _props$speed,\n      _props$size = props.size,\n      size = _props$size === void 0 ? 0.5 : _props$size,\n      _props$decay = props.decay,\n      decay = _props$decay === void 0 ? .20 : _props$decay,\n      _props$displace = props.displace,\n      displace = _props$displace === void 0 ? 0.40 : _props$displace,\n      _props$complex = props.complex,\n      complex = _props$complex === void 0 ? 0.45 : _props$complex,\n      _props$waves = props.waves,\n      waves = _props$waves === void 0 ? 13 : _props$waves,\n      _props$eqcolor = props.eqcolor,\n      eqcolor = _props$eqcolor === void 0 ? 30.0 : _props$eqcolor,\n      _props$rcolor = props.rcolor,\n      rcolor = _props$rcolor === void 0 ? 1 : _props$rcolor,\n      _props$gcolor = props.gcolor,\n      gcolor = _props$gcolor === void 0 ? 90 : _props$gcolor,\n      _props$bcolor = props.bcolor,\n      bcolor = _props$bcolor === void 0 ? 30 : _props$bcolor; // const [eventStream, setEvent] = useState(props.event);\n\n  var eventStream = props.event; // const [texture1] = useLoader(THREE.TextureLoader, ['./static/kitten.jpg'])\n\n  var options = // useMemo(\n  //     () => (\n  {\n    speed: speed,\n    size: size,\n    pointscale: .0,\n    decay: decay,\n    displace: displace,\n    complex: complex,\n    waves: waves,\n    eqcolor: eqcolor,\n    rcolor: rcolor,\n    gcolor: gcolor,\n    bcolor: bcolor,\n    rotateSpeed: rotateSpeed\n  }; //     ),\n  //     []\n  // );\n\n  var uniforms = useMemo(function () {\n    return {\n      time: {\n        type: \"f\",\n        value: options.speed / 1000 * start\n      },\n      pointscale: {\n        type: \"f\",\n        value: options.pointscale\n      },\n      decay: {\n        type: \"f\",\n        value: options.decay\n      },\n      size: {\n        type: \"f\",\n        value: options.size\n      },\n      displace: {\n        type: \"f\",\n        value: options.displace\n      },\n      complex: {\n        type: \"f\",\n        value: options.complex\n      },\n      waves: {\n        type: \"f\",\n        value: options.waves\n      },\n      eqcolor: {\n        type: \"f\",\n        value: options.eqcolor\n      },\n      rcolor: {\n        type: \"f\",\n        value: options.rcolor\n      },\n      gcolor: {\n        type: \"f\",\n        value: options.gcolor\n      },\n      bcolor: {\n        type: \"f\",\n        value: options.bcolor\n      }\n    };\n  }, []);\n\n  var _useState = useState(false),\n      active = _useState[0],\n      setActive = _useState[1]; // Rotate mesh every frame, this is outside of React without overhead\n\n\n  useFrame(function () {\n    // mesh.current.rotation.x = mesh.current.rotation.y += options.rotateSpeed;\n    shader.current.uniforms.time.value = options.speed / 1000 * (Date.now() - start);\n\n    if (includePoints) {\n      pointShader.current.uniforms.time.value = options.speed / 1000 * (Date.now() - start);\n    } // if (active) {\n    //   shader.current.uniforms.complex.value = 10;\n    //   shader.current.uniforms.eqcolor.value = 2;\n    // } else {\n    //   shader.current.uniforms.complex.value = options.complex\n    //   shader.current.uniforms.eqcolor.value = options.eqcolor\n    // }\n    // mesh.current.material.uniforms.waves.value = mesh.current.material.uniforms.waves.value + 0.01;\n    // mesh.current.material.uniforms.bcolor.value = mesh.current.material.uniforms.bcolor.value + 0.01;\n    // mesh.current.material.uniforms.eqcolor.value = mesh.current.material.uniforms.eqcolor.value + 0.01;\n    // mesh.current.material.uniforms.complex.value = mesh.current.material.uniforms.complex.value + 0.01;\n    // mesh.current.material.uniforms.decay.value = mesh.current.material.uniforms.decay.value + 0.01;\n\n\n    if (eventStream !== null) {\n      console.log(\"mesh.current.material.uniforms\", mesh.current.material.uniforms);\n      var ev = eventStream.split(\"-\");\n\n      if (ev[2] === \"ACTIVE\") {\n        if (ev[0] === \"ROTATE\") {\n          var coord = ev[1].toLowerCase();\n          mesh.current.rotation[coord] = mesh.current.rotation[coord] += options.rotateSpeed;\n        }\n\n        if (ev[0] === \"SCALE\") {\n          console.log(\"SCALE !!!\", mesh.current);\n          var direction = ev[1].toLowerCase();\n          var modifier = direction === \"up\" ? 0.01 : -0.01;\n          var curScale = mesh.current.scale.x;\n          var nextScale = curScale + modifier;\n          var cappedNextScale = nextScale < 0.3 ? 0.3 : nextScale > 1.8 ? 1.8 : nextScale;\n          mesh.current.scale.x = cappedNextScale;\n          mesh.current.scale.y = cappedNextScale;\n          mesh.current.scale.z = cappedNextScale;\n        }\n      }\n    }\n  });\n  return __jsx(\"group\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 5\n    }\n  }, includePoints && __jsx(\"points\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }\n  }, __jsx(\"icosahedronBufferGeometry\", {\n    attach: \"geometry\",\n    args: [16, 6],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 17\n    }\n  }), __jsx(\"shaderMaterial\", {\n    ref: pointShader,\n    attach: \"material\",\n    uniforms: uniforms,\n    fragmentShader: pointFragmentShader,\n    vertexShader: vertexShader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 17\n    }\n  })), __jsx(\"mesh\", _extends({\n    // onClick={e => setActive(!active)}\n    ref: mesh // position={mesh.current.waves[0, 0, 10]}\n\n  }, props, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 9\n    }\n  }), __jsx(\"icosahedronBufferGeometry\", {\n    attach: \"geometry\",\n    args: [2, 6],\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 13\n    }\n  }), __jsx(\"shaderMaterial\", {\n    ref: shader,\n    attach: \"material\",\n    side: THREE.DoubleSide,\n    uniforms: uniforms,\n    fragmentShader: fragmentShader,\n    vertexShader: vertexShader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 13\n    }\n  })));\n};\n\n_s(LeBlob, \"fzYt8XzWR5gmhfHrTADU8RvYDK4=\", false, function () {\n  return [useFrame];\n});\n\n_c = LeBlob;\nexport var Blob = function Blob(_ref) {\n  _s3();\n\n  var _s2 = $RefreshSig$();\n\n  var event = _ref.event;\n  var theme = useMemo(function () {\n    return {\n      bgGradFrom: '#E0E5EC',\n      bgGradTo: '#FFFFFF'\n    };\n  }, []);\n\n  function Camera(props) {\n    _s2();\n\n    var ref = useRef();\n\n    var _useThree = useThree(),\n        size = _useThree.size,\n        setDefaultCamera = _useThree.setDefaultCamera; // Make the camera known to the system\n\n\n    useEffect(function () {\n      return void setDefaultCamera(ref.current);\n    }, []); // Update it every frame\n    // useFrame(() => ref.current.updateMatrixWorld());\n\n    return __jsx(\"perspectiveCamera\", _extends({\n      ref: ref,\n      fov: \"35\",\n      aspect: size.width / size.height // radius={(size.width + size.height) / 4}\n      ,\n      near: 1,\n      far: 1000 // onUpdate={self => self.updateProjectionMatrix()}\n      ,\n      position: [0, 0, 26]\n    }, props, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 14\n      }\n    }));\n  }\n\n  _s2(Camera, \"m9xu+jIl5Dk2eo9yjXgiG+0QYZ4=\", false, function () {\n    return [useThree];\n  });\n\n  return __jsx(React.Fragment, null, __jsx(Canvas, {\n    shadowMap: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 9\n    }\n  }, __jsx(Camera, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 13\n    }\n  }), __jsx(Suspense, {\n    fallback: null,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 13\n    }\n  }, __jsx(LeBlob, {\n    includePoints: false // rotateSpeed={0.09}\n    // position={[0,0,10]}\n    ,\n    size: 0.3,\n    rcolor: 0,\n    gcolor: 1.2,\n    bcolor: 0.3,\n    decay: .3,\n    complex: 0.3,\n    displace: 1.3,\n    waves: 8,\n    eqcolor: 5,\n    event: event,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 23\n    }\n  })), __jsx(CameraControls, {\n    autoRotate: true,\n    enablePan: false,\n    enableZoom: false,\n    enableDamping: true,\n    dampingFactor: 0.5,\n    rotateSpeed: 1,\n    maxPolarAngle: Math.PI / 2,\n    minPolarAngle: Math.PI / 2,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 13\n    }\n  })));\n};\n\n_s3(Blob, \"TF0AHbRu8DO10P/SWtT0KIxHEhc=\");\n\n_c2 = Blob;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"LeBlob\");\n$RefreshReg$(_c2, \"Blob\");","map":{"version":3,"sources":["/home/t3hk/development/NextThree/components/blob/blob.js"],"names":["React","Suspense","useEffect","useMemo","useRef","useState","styled","THREE","meshline","Canvas","useFrame","useLoader","useThree","useUpdate","CameraControls","fragmentShader","vertexShader","pointVertexShader","pointFragmentShader","start","Date","now","LeBlob","props","mesh","shader","pointShader","includePoints","rotateSpeed","speed","size","decay","displace","complex","waves","eqcolor","rcolor","gcolor","bcolor","eventStream","event","options","pointscale","uniforms","time","type","value","active","setActive","current","console","log","material","ev","split","coord","toLowerCase","rotation","direction","modifier","curScale","scale","x","nextScale","cappedNextScale","y","z","DoubleSide","Blob","theme","bgGradFrom","bgGradTo","Camera","ref","setDefaultCamera","width","height","Math","PI"],"mappings":"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","sourcesContent":["import React, { Suspense, useEffect, useMemo, useRef, useState } from 'react';\nimport styled from 'styled-components'\nimport * as THREE from 'three';\nimport * as meshline from 'threejs-meshline';\nimport { Canvas, useFrame, useLoader, useThree, useUpdate } from 'react-three-fiber';\n\nimport CameraControls from './controls'\nimport { fragmentShader, vertexShader, pointVertexShader, pointFragmentShader } from './vertexShader';\n\n// import { useSpring, animated } from '@react-spring/three'\n\nconst start = Date.now();\n\nconst LeBlob = ( props ) => {\n    // This reference will give us direct access to the mesh\n    const mesh = useRef()\n    const shader = useRef()\n    const pointShader = useRef()\n\n    const {\n        includePoints = false,\n        rotateSpeed = 0.09,\n        speed= 0.4,\n        size= 0.5,\n        decay= .20,\n        displace= 0.40,\n        complex= 0.45,\n        waves= 13,\n        eqcolor= 30.0,\n        rcolor= 1,\n        gcolor= 90,\n        bcolor= 30,\n    } = props;\n\n    // const [eventStream, setEvent] = useState(props.event);\n    const eventStream = props.event\n    // const [texture1] = useLoader(THREE.TextureLoader, ['./static/kitten.jpg'])\n  \n    const options = \n    // useMemo(\n    //     () => (\n          {\n            speed,\n            size,\n            pointscale: .0,\n            decay,\n            displace,\n            complex,\n            waves,\n            eqcolor,\n            rcolor,\n            gcolor,\n            bcolor,\n            rotateSpeed\n        }\n    //     ),\n    //     []\n    // );\n\n    const uniforms = useMemo(\n      () => ({\n          time: {\n            type: \"f\",\n            value: (options.speed / 1000) * (start)\n          },\n          pointscale: {\n            type: \"f\",\n            value: options.pointscale\n          },\n          decay: {\n            type: \"f\",\n            value: options.decay\n          },\n          size: {\n            type: \"f\",\n            value: options.size\n          },\n          displace: {\n            type: \"f\",\n            value: options.displace\n          },\n          complex: {\n            type: \"f\",\n            value: options.complex\n          },\n          waves: {\n            type: \"f\",\n            value: options.waves\n          },\n          eqcolor: {\n            type: \"f\",\n            value: options.eqcolor\n          },\n          rcolor: {\n            type: \"f\",\n            value: options.rcolor\n          },\n          gcolor: {\n            type: \"f\",\n            value: options.gcolor\n          },\n          bcolor: {\n            type: \"f\",\n            value: options.bcolor\n          }\n      }),\n      []\n    );\n\n    const [active, setActive] = useState(false);\n\n    // Rotate mesh every frame, this is outside of React without overhead\n    useFrame(() => {\n        // mesh.current.rotation.x = mesh.current.rotation.y += options.rotateSpeed;\n        shader.current.uniforms.time.value = (options.speed / 1000) * (Date.now() - start);\n        if (includePoints) {\n            pointShader.current.uniforms.time.value = (options.speed / 1000) * (Date.now() - start);\n        }\n \n        // if (active) {\n        //   shader.current.uniforms.complex.value = 10;\n        //   shader.current.uniforms.eqcolor.value = 2;\n        // } else {\n        //   shader.current.uniforms.complex.value = options.complex\n        //   shader.current.uniforms.eqcolor.value = options.eqcolor\n        // }\n\n        // mesh.current.material.uniforms.waves.value = mesh.current.material.uniforms.waves.value + 0.01;\n        // mesh.current.material.uniforms.bcolor.value = mesh.current.material.uniforms.bcolor.value + 0.01;\n        // mesh.current.material.uniforms.eqcolor.value = mesh.current.material.uniforms.eqcolor.value + 0.01;\n        // mesh.current.material.uniforms.complex.value = mesh.current.material.uniforms.complex.value + 0.01;\n        // mesh.current.material.uniforms.decay.value = mesh.current.material.uniforms.decay.value + 0.01;\n        \n        if (eventStream !== null) {\n          console.log(\"mesh.current.material.uniforms\", mesh.current.material.uniforms)\n          const ev = eventStream.split(\"-\");\n          if (ev[2] === \"ACTIVE\") {\n            if (ev[0] === \"ROTATE\") {\n              const coord = ev[1].toLowerCase();\n              mesh.current.rotation[coord] = mesh.current.rotation[coord] += options.rotateSpeed;\n            }\n\n            if (ev[0] === \"SCALE\") {\n              console.log(\"SCALE !!!\", mesh.current)\n              const direction = ev[1].toLowerCase();\n              const modifier = direction === \"up\" ? 0.01 : -0.01;\n              const curScale = mesh.current.scale.x;\n\n              const nextScale = curScale + modifier;\n\n              const cappedNextScale = nextScale < 0.3 ? 0.3 : (nextScale > 1.8 ? 1.8 : nextScale);\n              \n              mesh.current.scale.x = cappedNextScale;\n              mesh.current.scale.y = cappedNextScale;\n              mesh.current.scale.z = cappedNextScale;\n            }\n          }\n        }\n    })\n\n    return (\n    <group>\n        {includePoints && (\n            <points>\n                <icosahedronBufferGeometry attach=\"geometry\" args={[16, 6]} />\n                <shaderMaterial ref={pointShader} attach=\"material\" uniforms={uniforms} fragmentShader={pointFragmentShader} vertexShader={vertexShader} />\n            </points>\n        )}\n        <mesh \n              // onClick={e => setActive(!active)}\n              ref={mesh}\n              // position={mesh.current.waves[0, 0, 10]}\n              {...props}\n            >\n            <icosahedronBufferGeometry  attach=\"geometry\" args={[2, 6]} />\n            <shaderMaterial ref={shader} attach=\"material\" side={THREE.DoubleSide} uniforms={uniforms} fragmentShader={fragmentShader} vertexShader={vertexShader} />\n        </mesh>\n    </group>\n    )\n}\n\nexport const Blob = ({event}) => {\n    const theme = useMemo(\n        () => ({\n            bgGradFrom: '#E0E5EC',\n            bgGradTo: '#FFFFFF',\n        }),\n        []\n    );\n\n    function Camera(props) {\n      const ref = useRef()\n      const { size, setDefaultCamera } = useThree();\n      \n      // Make the camera known to the system\n      useEffect(() => void setDefaultCamera(ref.current), [])\n      // Update it every frame\n      // useFrame(() => ref.current.updateMatrixWorld());\n\n      return <perspectiveCamera ref={ref}\n          fov=\"35\"\n          aspect={size.width / size.height}\n          // radius={(size.width + size.height) / 4}\n          near={1}\n          far={1000} \n          // onUpdate={self => self.updateProjectionMatrix()}\n          position={[0, 0, 26]} \n          {...props}\n          />\n    }\n\n    return (\n      <>\n        <Canvas shadowMap>\n            <Camera />\n            <Suspense fallback={null}>\n                {/* <LeBlob /> */}\n                {/* <LeBlob\n                    includePoints={false}\n                    rotateSpeed={0.09}\n                    // position={[0,0,10]}\n                    size={0.35}\n                    rcolor={10}\n                    gcolor={20}\n                    bcolor={60}\n                    /> */}\n                    {/* <LeBlob\n                      includePoints={false}\n                      // rotateSpeed={0.09}\n                      // position={[0,0,10]}\n                      size={0.3}\n                      rcolor={.45}\n                      gcolor={2}\n                      bcolor={.8}\n                      decay={.3}\n                      complex={0.3}\n                      displace={1.3}\n                      waves={8}\n                      eqcolor={11}\n                      /> */}\n                      <LeBlob\n                        includePoints={false}\n                        // rotateSpeed={0.09}\n                        // position={[0,0,10]}\n                        size={0.3}\n                        rcolor={0}\n                        gcolor={1.2}\n                        bcolor={0.3}\n                        decay={.3}\n                        complex={0.3}\n                        displace={1.3}\n                        waves={8}\n                        eqcolor={5}\n\n                        event={event}\n                      />\n                  {/* <LeBlob\n                    includePoints={false}\n                    // rotateSpeed={0.09}\n                    // position={[0,0,10]}\n                    size={0.35}\n                    rcolor={10}\n                    gcolor={20}\n                    bcolor={60}\n                    decay={4}\n                    speed={0.1}\n                    /> */}\n            </Suspense>\n\n            <CameraControls\n                autoRotate\n                enablePan={false}\n                enableZoom={false}\n                enableDamping\n                dampingFactor={0.5}\n                rotateSpeed={1}\n                maxPolarAngle={Math.PI / 2}\n                minPolarAngle={Math.PI / 2}\n            />\n        </Canvas>\n      </>\n    );\n}"]},"metadata":{},"sourceType":"module"}